var documenterSearchIndex = {"docs":
[{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"EditURL = \"https://github.com/akels/LaplaceBIE.jl/blob/master/examples/mdrop.jl\"","category":"page"},{"location":"mdrop/#Magnetic-liquid-droplet-in-magnetic-field-1","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"","category":"section"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"The behaviour of droplets under the action of magnetic fields of different configurations is an important issue in many domains, including microfluidics (Seeman et al. 2012), mechanics of tissues (Douezan et al. 2011; Frasca et al. 2014), studies of dynamic self-assembly (Timonen et al. 2013) and many others. After the successful synthesis of magnetic fluids in the late sixties by (Rosensweig 1985) an exciting story about droplets of magnetic fluid began. At first, the elongation of the droplets in an external field was observed and explained by Arhipenko et al. (1978). Later on, different droplet configurations were experimentally observed in the high-frequency rotating field, which was subject to our numerical study in [1].","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"Here I present the essential ingredients to reproduce the results of the paper with the new tools SurfaceTopology, LaplaceBIE and ElTopo (optional).","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"using LinearAlgebra\nusing GeometryTypes\nusing SurfaceTopology\nusing LaplaceBIE\nusing AbstractPlotting, GLMakie\n# using ElTopo","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"The calculation requires normal vector and vertex areas methods. Latter one gives the area of 1/3 of the vertex ring, so the sum is the area of the droplet.","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"function normals(vertices,topology)\n    n = Point{3,Float64}[]\n    for v in 1:length(vertices)\n        s = Point(0,0,0)\n        for (v1,v2) in EdgeRing(v,topology)\n            s += cross(vertices[v1],vertices[v2])\n        end\n        normal = s ./ norm(s)\n        push!(n,normal)\n    end\n    return n\nend\n\nfunction vertexareas(points,topology)\n    vareas = zeros(Float64,length(points))\n    for face in Faces(topology)\n        v1,v2,v3 = face\n        area = norm(cross(points[v3]-points[v1],points[v2]-points[v1])) /2\n        vareas[v1] += area/3\n        vareas[v2] += area/3\n        vareas[v3] += area/3\n    end\n    return vareas\nend","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"These are tools to keep track if the calculation is sensible. Since we are working in an incompressible fluid, the volume needs to be constant, and the energy of the droplet decreases until equilibrium is reached.","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"function surfacevolume(points,topology)\n    normal0 = [0,0,1]\n    s = 0\n    for face in Faces(topology)\n        y1 = points[face[1]]\n        y2 = points[face[2]]\n        y3 = points[face[3]]\n\n        normaly = cross(y2-y1,y3-y1)\n        normaly /= norm(normaly)\n\n        area = norm(cross(y2-y1,y3-y1))/2\n        areaproj = dot(normaly,normal0)*area\n        volume = dot(y1 + y2 + y3,normal0)/3*areaproj\n\n        s += volume\n    end\n    return s\nend\n\nfunction energy(points,normals,faces,psi,mup,gammap,H0)\n    vareas = vertexareas(points,faces)\n    Area = sum(vareas)\n\n    s = 0\n    for xkey in 1:length(points)\n        s += psi[xkey]*dot(H0,normals[xkey]) * vareas[xkey]\n    end\n\n    Es = gammap * Area\n    Em = 1/8/pi * (1 - mup) * s\n\n    return Es+Em\nend","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"For calculating the equilibrium of the droplet, we use a curvatureless algorithm for a vicious droplet developed by Zinchenko 1997. He found a way to calculate velocity generated by a surface tension without explicitly calculating the curvature, which makes it easier to implement and from some tests also more stable. The following method accepts surface defined by points, normals and faces (or topology) and surface force as well as surface tension γ and viscosity η (which only affects the scaling of time).","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"function stokesvelocity(points,normals,faces,forcen,etaP,gammap)\n    vareas = vertexareas(points,faces)\n    velocityn = zeros(Float64,length(points))\n\n    for xkey in 1:length(points)\n\n        x = points[xkey]\n        nx = normals[xkey]\n        fx = forcen[xkey]\n\n        s = 0\n        for ykey in 1:length(points)\n            if ykey==xkey\n                continue\n            end\n\n            y = points[ykey]\n            ny = normals[ykey]\n            fy = forcen[ykey]\n\n            ### Need to check a missing 2\n            s += vareas[ykey]*1 ./8/pi/etaP* dot(y-x,nx+ny)/norm(y-x)^3*(1-3*dot(y-x,nx)*dot(y-x,ny)/norm(y-x)^2) * gammap\n            s += vareas[ykey]*1 ./8/pi/etaP* ( dot(nx,ny)/norm(x-y) + dot(nx,x -y)*dot(ny,x-y)/norm(x-y)^3 )*(fy - fx)\n        end\n        velocityn[xkey] = s\n    end\n    return velocityn\nend","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"Now having methods defined, we can include a sphere and proceed with calculation.","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"include(\"sphere.jl\")\nmsh = unitsphere(2)\nvertices, faces = msh.vertices, msh.faces\n\n# Now let's do something fun. Visualize the process with Makie in real time.\nx = Node(msh)\ny = lift(x->x,x)\n\nscene = Scene(show_axis=false)\n\nwireframe!(scene,y,linewidth = 3f0)\nmesh!(scene,y, color = :white, shading = false)\n\ndisplay(scene)\n\n# Initial parameters\nH0 = [4.,0.,0.]\netap = 1.\ngammap = 1.\nμ = 10.\n\nt = 0.\nΔt = 0.1\nN = 100\nvolume0 = surfacevolume(vertices,faces)\n\nrecord(scene, \"mdrop.gif\", 1:N) do i # for i in 1:N\n    n = normals(vertices,faces)\n\n    psi = surfacepotential(vertices,n,faces,μ,H0)\n    P∇ψ = tangentderivatives(vertices,n,faces,psi)\n    Hn = normalderivatives(vertices,n,faces,P∇ψ,μ,H0)\n\n    E = energy(vertices,n,faces,psi,μ,gammap,H0)\n    rV = surfacevolume(vertices,faces)/volume0\n    @show E,rV\n\n    Ht = [norm(j) for j in P∇ψ]","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"The force generated (M⋅∇)H, which includes a jump of magnetization at the surface and force coming from the whole bulk.","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"    tensorn = μ*(μ-1)/8/pi * Hn.^2 + (μ-1)/8/pi * Ht.^2\n\n    vn = stokesvelocity(vertices,n,faces,tensorn,etap,gammap)\n\n    vertices .+= n .* vn * Δt\n\n    msh = HomogenousMesh(vertices,faces)\n\n    ### ElTopo stabilization\n    # par = SurfTrack(allow_vertex_movement=true)\n    # msh = stabilize(msh,par)\n\n    push!(x,msh)\n    AbstractPlotting.force_update!()\n\n    global vertices, faces = msh.vertices, msh.faces\n    global t += Δt\nend","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"(Image: )","category":"page"},{"location":"mdrop/#","page":"Magnetic liquid droplet in magnetic field","title":"Magnetic liquid droplet in magnetic field","text":"[1]: Erdmanis, J. & Kitenbergs, G. & Perzynski, R. & Cebers, A. (2017) Magnetic micro-droplet in rotating field: numerical simulation and comparison with experiment","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"EditURL = \"https://github.com/akels/LaplaceBIE.jl/blob/master/examples/homogenous.jl\"","category":"page"},{"location":"homogenous/#A-sphere-in-a-homogenous-field-1","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"","category":"section"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"For a three axial ellipsoid in a constant field, we have an analytic solution expressed in terms of demagnetization coefficients n_i:","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"H_i = fracH_0i(1 + (mu-1)n_i)","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"whre vec H is the interior field, and vec H_0 is the constant field. That makes ellipsoid a perfect subject to test the numerics.","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"using QuadGK\n\nfunction ellipsoid_demagnetization_coefficients(a,b,c)\n\n    UP_BOUND = 1000\n\n    Ru2(u) = (u+a^2)*(u+b^2)*(u+c^2)\n\n    nx = 1/2 * a*b*c * quadgk(s -> 1/(s+a^2)/sqrt(Ru2(s)), 0, UP_BOUND)[1]\n    ny = 1/2 * a*b*c * quadgk(s -> 1/(s+b^2)/sqrt(Ru2(s)), 0, UP_BOUND)[1]\n    nz = 1/2 * a*b*c * quadgk(s -> 1/(s+c^2)/sqrt(Ru2(s)), 0, UP_BOUND)[1]\n\n    return [nx, ny, nz]\nend\n\nfunction EllipsoidField(a,b,c,mu,H0)\n\n    H0x, H0y, H0z = H0\n    nx, ny, nz = ellipsoid_demagnetization_coefficients(a,b,c)\n\n    Hix = H0x/(1 + (mu-1)*nx)\n    Hiy = H0y/(1 + (mu-1)*ny)\n    Hiz = H0z/(1 + (mu-1)*nz)\n\n    return [Hix,Hiy,Hiz]\nend;","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"We define that we have a field of strength H_0 = e_z. A corresponding potential for that is psi_0 = z, which we need to pass to the solver.","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"using LaplaceBIE\nusing LinearAlgebra\n\nH0 = [0,0,1]\n\nψ0(x) = dot(x,H0)\n∇ψ0(x) = H0;","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"For simplicity, we consider a sphere with relative permittivity epsilon=15. The mesh for the sphere we generate from subdivisions of icosahedron given in sphere.jl. We also need normal vectors which we get from the vertex positions with high accuracy","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"ϵ = 15\n\ninclude(\"sphere.jl\")\nmsh = unitsphere(3)\nvertices, faces = msh.vertices, msh.faces\nn = vertices;","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"At the moment users need to take the derivative of the potential themselves which can be done in multiple ways. It is also possible that a user might wish to calculate the field due to the surface current for which normalderivatives method could be useful.","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"Now we can proceed with calculation. To calculate surface potential everywhere on the surface one executes a method","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"ψ = surfacepotential(vertices,n,faces,ϵ,ψ0);","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"which solves a regularized boundary integral equation with BLAS. That then, for example, can be used to calculate the energy of the field.","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"Usually, however, one wants to know the field on the surface for force calculations due to (M cdot nabla)H. The library offers to do a finite differentiation on the calculated potential for calculating tangential field components. That can be easily achieved with method tangentderivatives:","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"P∇ψ = tangentderivatives(vertices,n,faces,ψ);","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"And lastly to calculate the normal derivatives, we can use Biot-Savarat law treating the tangential field as raising from a surface current:","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"n∇ψ = normalderivatives(vertices,n,faces,P∇ψ,ϵ,∇ψ0);","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"We can compare numerics with analytics easily by the use of azimuthal symmetry in the z-direction. The normal field is equal to potential since vertex positions coincide with normals which is thus not shown twice. And so the comparison:","category":"page"},{"location":"homogenous/#","page":"A sphere in a homogenous field","title":"A sphere in a homogenous field","text":"Hin = EllipsoidField(1,1,1,ϵ,H0)\n\nx = [v[3] for v in vertices]\nsp = sortperm(x)\n\nfor xkey in sp[2:43:end]\n    psit = dot(Hin,vertices[xkey])\n    println(\"$(vertices[xkey][3]) \\t $psit \\t $(ψ[xkey]) \\t $(n∇ψ[xkey])\")\nend","category":"page"},{"location":"#Theory-and-introduction-1","page":"Theory and introduction","title":"Theory and introduction","text":"","category":"section"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"Since ancient times people had wondered what makes amber rubbed with fur to attract small light objects and what makes lodestones, naturally magnetized pieces of the mineral magnetite, to attract iron. Nowadays we do have an answer that the force comes from magnetization or polarization gradient. However, even for linear materials, the computation of the force is challenging as the body itself perturbs the field. Fortunately, boundary integral methods can save our day [1], which are implemented in this library and can be used to calculate the field and so also a force at an arbitrary object's surface.","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"To start with we introduce a potential ψ whose gradient is either electric or magnetic field. In the absence of singularities (charges, dipoles and etc.) the potential satisfies Laplace equation Δψ=0. It is well known from the Green theorem that Laplace equation can also be written in integral form:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"int_partial Omega fracpartial psipartial n_boldsymbol x frac1boldsymbol x - boldsymbol y dS_boldsymbolx\n-int_partial Omega psi(boldsymbol x) fracpartialpartial n_boldsymbol x frac1boldsymbol x - boldsymbol y dS_boldsymbolx\n=left\n    beginarrayll\n      4pi psi(boldsymbol y) ifboldsymboly in Omega \n      2 pi psi(boldsymbol y)ifboldsymboly in partial Omega \n      0 ifboldsymboly ni Omega \n    endarray\n  right","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"This integral is flexible in the sense that we can wrap the surface around singularities, infinity and objects, and we can apply it to the interior of objects with linear properties.","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"Let's consider the system shown in the figure:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"(Image: )","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"We have singularities denoted by S_n, object Omega and infinity infty. Since at infinity the field perturbation from the object is vanishingly small we can set it equal to the free field. Similarly, the field near the singularity approaches the field of the singularity, and we can neglect the effects of the body. Thus we have an identity:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"  int_partial infty + int_partial S = 4 pi psi_0 (boldsymbol y)","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"where the left side is integral over the surface of singularities and infinity, and the right side is the field in the absence of bodies.","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"To model the field in the presence of bodies, we only need to set appropriate boundary conditions, which are:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"beginarrayrcl\npsi^in = psi^out = psi  mu fracpartial psi^inpartial n = fracpartial psi^outpartial n = fracpartial psipartial n\nendarray","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"which implies a linear material. Applying the boundary integral to the interior of the object and matching boundary conditions with the exterior surface, we arrive at the useful formula:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"int_partial Omega fracpartial psi^outpartial n_x frac1boldsymbol x - boldsymbol y dS_boldsymbol x = frac2 mumu + 1 int_partial Omega psi(boldsymbol x) fracpartialpartial n_x frac1boldsymbol x - boldsymbol y dS_boldsymbol x","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"That we can use to obtain a boundary integral equation for the potential:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"  psi(boldsymbol y) = 2 psi_0(boldsymbol y)  + fracmu - 1mu + 1 int_partial Omega (psi(boldsymbol x)-psi(boldsymbol y)) fracpartialpartial n_x frac1boldsymbol x - boldsymbol y dS_boldsymbol x","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"where we used identity int_partial Omega fracpartialpartial n_x frac1boldsymbol x - boldsymbol y dS_boldsymbol x=0 for regularization.","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"Another way of writing the Laplace equation in the BIE form is as follows:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"int_partial Omega (nabla_boldsymbol x psi times boldsymbol n_boldsymbol x) nabla_x frac1boldsymbol x - boldsymbol y dS_boldsymbolx\n-int_partial Omega fracpartial psipartial n_boldsymbol x nabla_boldsymbol x  frac1boldsymbol x - boldsymbol y dS_boldsymbolx\n=left\n    beginarrayll\n      4pi nabla psi(boldsymbol y) ifboldsymboly in Omega \n      2 pi nabla psi(boldsymbol y)ifboldsymboly in partial Omega \n      0 ifboldsymboly ni Omega \n    endarray\n  right","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"From a similar argument, we obtain","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"  int_partial infty + int_partial S = 4 pi nabla psi_0 (boldsymbol y)","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"And from boundary conditions, we can get a formula:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"boldsymbol n_boldsymbol y cdot int fracpartial psipartial n nabla_boldsymbol x frac1boldsymbolx - boldsymboly dS_boldsymbol x = fracmu + 12 boldsymbol n_boldsymbol y int (nabla psi times boldsymbol n_boldsymbol x) nabla_boldsymbol x frac1boldsymbolx - boldsymboly dS_boldsymbol x","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"That we substitute back to obtain:","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"  fracpartial psi^inpartial n_boldsymbol y = 2 nabla psi_0 cdot boldsymbol n_boldsymbol y - fracmu -14 pi boldsymbol n_boldsymbol y cdot int (nabla psi times boldsymbol n_boldsymbol x) times nabla_boldsymbol x frac1boldsymbolx - boldsymboly dS_boldsymbol x","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"which corresponds to a Biot-Savarat integral over the surface current. In numerics, a regularized version is used (for derivation see [1]):","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"  fracpartial psi^inpartial n_boldsymbol y = 2 nabla psi_0 cdot boldsymbol n_boldsymbol y - fracmu -14 pi boldsymbol n_boldsymbol y cdot int (Pnabla psi(boldsymbol x) - P nabla psi (boldsymbol y) ) times left( boldsymbol n_boldsymbol x times nabla_boldsymbol x frac1boldsymbolx - boldsymboly right) dS_boldsymbol x","category":"page"},{"location":"#Implementation-and-API-1","page":"Theory and introduction","title":"Implementation and API","text":"","category":"section"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"The boundary integral equations are solved with the collocation method on a triangular mesh. The simplest quadrature ∫ΔfdS=(f1+f2+f3)/3 is used for all nonsingular elements. Whereas for Biot-Savarat integral for normal derivatives, a weakly singular quadrature is implemented to deal with elements near the singularity.  To obtain tangential derivatives of the potential, we do numerical differentiation of previously calculated potential and use least squares to solve the overdetermined system. ","category":"page"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":" Modules = [LaplaceBIE]","category":"page"},{"location":"#LaplaceBIE.normalderivatives-Tuple{Any,Any,Any,Any,Any,Function}","page":"Theory and introduction","title":"LaplaceBIE.normalderivatives","text":"normalderivatives(points,normals,topology,P∇ψ,μ,∇ψ0::Function; eps=0.0001, NP=100)\n\nCalculates ∇ψ.n approached to the object surface from interior region. To use the function surface properties points, normals and topology are required. To use the function it is required to have a tangential field components (see tangentialderivatives and surfacepotential), boundary jump condition μ and a gradient of external free field. \n\n\n\n\n\n","category":"method"},{"location":"#LaplaceBIE.surfacepotential-Tuple{Any,Any,Any,Any,Function}","page":"Theory and introduction","title":"LaplaceBIE.surfacepotential","text":"surfacepotential(points,normals,topology,μ,ψ0::Function)\n\nReturns a surface field for a given shape defined by a triangular mesh with points, normals and topology and for a boundary conditions where ∇ψ has a jump in th e normal direction charectarized with μ and for the external free field given by a potential ψ0.\n\n\n\n\n\n","category":"method"},{"location":"#LaplaceBIE.tangentderivatives-NTuple{4,Any}","page":"Theory and introduction","title":"LaplaceBIE.tangentderivatives","text":"tangentderivatives(points,normals,topology,ψ)\n\nReturns tangential derivative P∇ψ for a shape defined by points, normals and topology.\n\n\n\n\n\n","category":"method"},{"location":"#","page":"Theory and introduction","title":"Theory and introduction","text":"[1]: Erdmanis, J. & Kitenbergs, G. & Perzynski, R. & Cebers, A. (2017) Magnetic micro-droplet in rotating field: numerical simulation and comparison with experiment","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"EditURL = \"https://github.com/akels/LaplaceBIE.jl/blob/master/examples/pointlike.jl\"","category":"page"},{"location":"pointlike/#A-sphere-in-a-point-charge-field.-1","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"","category":"section"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"In general, the LaplaceBIE allows finding the field on the body's surface if the potential in the absence of an object(s) is known. (Though one can not add objects one by one to get the solution directly. One, however, should be able to make an iterative scheme in the lines of multipole method.) To demonstrate that, let's consider a field on the dielectric sphere (radius r1) due to a point charge at distance ζ away. The solution inside the sphere is given as series [Straton page 221]:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"psi = sum_n=0^infty frac2n + 1epsilon n + n + 1 fracr_1^nzeta^n+1 L_n(cos theta)","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"where L_n is Legendre polynomial and theta angle from line connecting point charge and spehre.","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"using Jacobi\nfunction ψt(cosθ,ϵ,ζ,r1)\n    s = 0\n    for n in 0:25\n        s += (2*n + 1)/(n*ϵ + n + 1)*r1^n/ζ^(n+1)*legendre(cosθ,n)\n    end\n    return s\nend","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"The normal derivative can also be given for the sphere which coincides with derivative in the radial direction:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"fracpartial psipartial n = sum_n=0^infty fracn(2n + 1)epsilon n + n + 1 fracr_1^n-1zeta^n+1 L_n(cos theta)","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"function ∇ψn(cosθ,ϵ,ζ,r1)\n    s = 0\n    for n in 1:25\n        s += n*(2*n + 1)/(n*ϵ + n + 1)*r1^(n-1)/ζ^(n+1) * legendre(cosθ,n)\n    end\n    return s\nend","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"First, we can define the exterior potential in the absence of objects:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"using LinearAlgebra\n\nζ = 1.2\nr1 = 1\ny = [0,0,ζ]\n\nψ0(x) = 1/norm(x.-y)\n∇ψ0(x) = -(x.-y)/norm(x.-y)^3","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"Let's now place a sphere in the field with relative permittivity epsilon=10.","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"ϵ = 10\n\ninclude(\"sphere.jl\")\nmsh = unitsphere(2)\nvertices, faces = msh.vertices, msh.faces\nn = vertices","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"With LaplaceBIE to calculate the surface field, we execute these three lines:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"using LaplaceBIE\n\nψ = surfacepotential(vertices,n,faces,ϵ,ψ0);\nP∇ψ = tangentderivatives(vertices,n,faces,ψ);\nn∇ψ = normalderivatives(vertices,n,faces,P∇ψ,ϵ,∇ψ0);","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"Now to compare with analytics, we use azimuthal symmetry, which in numerics was chosen as the x-axis:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"using Winston\n\ncosθ = range(-1,1,length=100)\ncosθs = [x[3]/1 for x in vertices]","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"Potential on the surface vs analytics:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"scatter(cosθs,ψ)\noplot(cosθ,ψt.(cosθ,ϵ,ζ,r1) )\nsavefig(\"potential.svg\")","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"(Image: )","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"Normal derivatives on the surface vs analytics:","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"scatter(cosθs,n∇ψ)\noplot(cosθ,∇ψn.(cosθ,ϵ,ζ,r1) )\nsavefig(\"nderivatives.svg\")","category":"page"},{"location":"pointlike/#","page":"A sphere in a point charge field.","title":"A sphere in a point charge field.","text":"(Image: )","category":"page"}]
}
