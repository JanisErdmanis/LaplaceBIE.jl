<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory and introduction · LaplaceBIE.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>LaplaceBIE.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Theory and introduction</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Implementation-and-API-1">Implementation and API</a></li></ul></li><li><a class="toctext" href="homogenous/">Sphere in a homogenous field</a></li><li><a class="toctext" href="pointlike/">Sphere in a point charge field.</a></li><li><a class="toctext" href="mdrop/">Magnetic liquid droplet in magnetic field</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Theory and introduction</a></li></ul><a class="edit-page" href="https://github.com/akels/LaplaceBIE.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Theory and introduction</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Theory-and-introduction-1" href="#Theory-and-introduction-1">Theory and introduction</a></h1><p>Since ancient times people had wondered what makes amber rubbed with fur to attract small light objects and what makes lodestones, naturally magnetized pieces of the minereal magnetite, to atract iron. Nowadays we do have an answer that the force comes from magnetization or polarization gradient. However, even for linear materials, the computation of the force is a challenge due to secondary field effects. Fortunately, boundary integral methods can save our day<a href="#footnote-1">[1]</a>, which are implemented in this library and can be used to calculate the field and so also a force at an arbitrary object&#39;s surface.</p><p>To start with we introduce a potential <span>$\psi$</span> whose gradient is either electric or magnetic field. In absence of singularitities (charges, dipoles and etc.) the potential satisfies Laplace equation <span>$\Delta \psi = 0$</span> which can also be written in boundary integral form:</p><div>\[\int_{\partial \Omega} \frac{\partial \psi}{\partial n_{\boldsymbol x}} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol{x}}
-\int_{\partial \Omega} \psi(\boldsymbol x) \frac{\partial}{\partial n_{\boldsymbol x}} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol{x}}
=\left\{
    \begin{array}{ll}
      4\pi \psi(\boldsymbol y) ~&amp;if~\boldsymbol{y} \in \Omega \\
      2 \pi \psi(\boldsymbol y)~&amp;if~\boldsymbol{y} \in \partial \Omega \\
      0 ~&amp;if~\boldsymbol{y} \ni \Omega 
    \end{array}
  \right.\]</div><p>This integral is flexible in the sense that we can wrap the surface around singularities, infinity and objects and we can apply it to the interior of objects with linear properties.</p><p>Let&#39;s consider the system shown in the figuere:</p><p><img src="setup.svg" alt/></p><p>We have singularites denoted by <span>$S_n$</span>, object <span>$\Omega$</span> and infinity <span>$\infty$</span>. Since at infinity the field perturbation of the object is vanishingly small we can set it equal to free field. Similarly the field near the singularity is equal to the field of the singularity and we can neglect effects of the body. Thus we have identity:</p><div>\[  \int_{\partial \infty} + \int_{\partial S} = 4 \pi \psi_{0} (\boldsymbol y)\]</div><p>where left side is integral over surface of singularities and infinity and the right side is the field in absence of bodies.</p><p>To model the bodies inside the field we only need to set a appropriate boundary conditions which are:</p><p>This particular package is built with a following boundary conditions</p><div>\[\psi^{in} = \psi^{out} = \psi; \mu \frac{\partial \psi^{in}}{\partial n} = \frac{\partial \psi^{out}}{\partial n} = \frac{\partial \psi}{\partial n}\]</div><p>which implies a linear material. Applying the boundary integral to the interior of the object and matching boundary conditions with exterior surface we arrive at useful formula:</p><div>\[\int_{\partial \Omega} \frac{\partial \psi^{out}}{\partial n_x} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol x} = \frac{2 \mu}{\mu + 1} \int_{\partial \Omega} \psi(\boldsymbol x) \frac{\partial}{\partial n_{x}} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol x}\]</div><p>Which we can apply to obrtain boundary integral equation for the potential</p><div>\[  \psi(\boldsymbol y) = 2 \psi_{0}(\boldsymbol y)  + \frac{\mu - 1}{\mu + 1} \int_{\partial \Omega} (\psi(\boldsymbol x)-\psi(\boldsymbol y)) \frac{\partial}{\partial n_x} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol x}\]</div><p>where we used identity <span>$\int_{\partial \Omega} \frac{\partial}{\partial n_x} \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol x}=0$</span> for regularization.</p><p>Another way of writting Laplace equation in BIE form is as follows:</p><div>\[\int_{\partial \Omega} (\nabla_{\boldsymbol x} \psi \times \boldsymbol n_{\boldsymbol x}) \nabla_x \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol{x}}
-\int_{\partial \Omega} \frac{\partial \psi}{\partial n_{\boldsymbol x}} \nabla_{\boldsymbol x}  \frac{1}{|\boldsymbol x - \boldsymbol y|} dS_{\boldsymbol{x}}
=\left\{
    \begin{array}{ll}
      4\pi \nabla \psi(\boldsymbol y) ~&amp;if~\boldsymbol{y} \in \Omega \\
      2 \pi \nabla \psi(\boldsymbol y)~&amp;if~\boldsymbol{y} \in \partial \Omega \\
      0 ~&amp;if~\boldsymbol{y} \ni \Omega 
    \end{array}
  \right.\]</div><p>math</p><p>From a similar arguments we obtain</p><div>\[  \int_{\partial \infty} + \int_{\partial S} = 4 \pi \nabla \psi_{0} (\boldsymbol y)\]</div><p>Applying boundary conditions give us a formula</p><div>\[\boldsymbol n_{\boldsymbol y} \cdot \int \frac{\partial \psi}{\partial n} \nabla_{\boldsymbol x} \frac{1}{|\boldsymbol{x} - \boldsymbol{y}|} dS_{\boldsymbol x} = \frac{\mu + 1}{2} \boldsymbol n_{\boldsymbol y} \int (\nabla \psi \times \boldsymbol n_{\boldsymbol x}) \nabla_{\boldsymbol x} \frac{1}{|\boldsymbol{x} - \boldsymbol{y}|} dS_{\boldsymbol x}\]</div><p>which we substitute back to obtain:</p><div>\[  \frac{\partial \psi^{in}}{\partial n_{\boldsymbol y}} = 2 \nabla \psi_0 \cdot \boldsymbol n_{\boldsymbol y} - \frac{\mu -1}{4 \pi} \boldsymbol n_{\boldsymbol y} \cdot \int (\nabla \psi \times \boldsymbol n_{\boldsymbol x}) \times \nabla_{\boldsymbol x} \frac{1}{|\boldsymbol{x} - \boldsymbol{y}|} dS_{\boldsymbol x}\]</div><p>It is interesting to note that it is a Biot-Svarat integral over the surface current which models the field configuration in presence of object. A regularized version can be obtained (look into article on magnetic liquid droplet)</p><div>\[  \frac{\partial \psi^{in}}{\partial n_{\boldsymbol y}} = 2 \nabla \psi_0 \cdot \boldsymbol n_{\boldsymbol y} - \frac{\mu -1}{4 \pi} \boldsymbol n_{\boldsymbol y} \cdot \int (P\nabla \psi(\boldsymbol x) - P \nabla \psi (\boldsymbol y) ) \times \left( \boldsymbol n_{\boldsymbol x} \times \nabla_{\boldsymbol x} \frac{1}{|\boldsymbol{x} - \boldsymbol{y}|} \right) dS_{\boldsymbol x}\]</div><h1><a class="nav-anchor" id="Implementation-and-API-1" href="#Implementation-and-API-1">Implementation and API</a></h1><p>The boundary integral equations are solved with collocation metheod on a triangular mesh. The simplest quadrature <span>$\int_\Delta f dS = (f_1 + f_2 + f_3)/3$</span> is used for all nonsingular elements. In order to obtain tangential derivatives of the potential we use numerical differentiation of previosly calculated potential and use least squares to solve the overdetermined system. And lastly for Biot-Savarat integral weakly singular quadrature is implemneted to deal with elements near the singularity where for other elements <span>$\int_\Delta f dS = (f_1 + f_2 + f_3)/3$</span> is used.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LaplaceBIE.normalderivatives-Tuple{Any,Any,Any,Any,Any,Function}" href="#LaplaceBIE.normalderivatives-Tuple{Any,Any,Any,Any,Any,Function}"><code>LaplaceBIE.normalderivatives</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">normalderivatives(points,normals,topology,P∇ψ,μ,∇ψ0::Function; eps=0.0001, NP=100)</code></pre><p>Calculates ∇ψ.n approached to the object surface from <em>interior</em> region. To use the function surface properties <code>points</code>, <code>normals</code> and <code>topology</code> are required. To use the function it is required to have a tangential field components (see <code>tangentialderivatives</code> and <code>surfacepotential</code>), boundary jump condition μ and a gradient of external free field. </p></div></div><a class="source-link" target="_blank" href="https://github.com/akels/LaplaceBIE.jl/blob/c045e4da77b004f6a9116931b47829a0b6d81c27/src/LaplaceBIE.jl#L60-L64">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LaplaceBIE.surfacepotential-Tuple{Any,Any,Any,Any,Function}" href="#LaplaceBIE.surfacepotential-Tuple{Any,Any,Any,Any,Function}"><code>LaplaceBIE.surfacepotential</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">surfacepotential(points,normals,topology,μ,ψ0::Function)</code></pre><p>Returns a surface field for a given shape defined by a triangular mesh with <code>points</code>, <code>normals</code> and <code>topology</code> and for a boundary conditions where ∇ψ has a jump in th e normal direction charectarized with μ and for the external free field given by a potential ψ0.</p></div></div><a class="source-link" target="_blank" href="https://github.com/akels/LaplaceBIE.jl/blob/c045e4da77b004f6a9116931b47829a0b6d81c27/src/LaplaceBIE.jl#L169-L173">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LaplaceBIE.tangentderivatives-NTuple{4,Any}" href="#LaplaceBIE.tangentderivatives-NTuple{4,Any}"><code>LaplaceBIE.tangentderivatives</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">tangentderivatives(points,normals,topology,ψ)</code></pre><p>Returns tangential derivative P∇ψ for a shape defined by <code>points</code>, <code>normals</code> and <code>topology</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/akels/LaplaceBIE.jl/blob/c045e4da77b004f6a9116931b47829a0b6d81c27/src/LaplaceBIE.jl#L123-L127">source</a></section><div class="footnote" id="footnote-1"><a href="#footnote-1"><strong>[1]</strong></a><p>Erdmanis, J. &amp; Kitenbergs, G. &amp; Perzynski, R. &amp; Cebers, A. (2017) Magnetic micro-droplet in rotating field: numerical simulation and comparison with experiment</p></div><footer><hr/><a class="next" href="homogenous/"><span class="direction">Next</span><span class="title">Sphere in a homogenous field</span></a></footer></article></body></html>
