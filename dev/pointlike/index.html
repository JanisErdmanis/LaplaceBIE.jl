<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A sphere in a point charge field. · LaplaceBIE.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>LaplaceBIE.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Theory and introduction</a></li><li><a class="toctext" href="../homogenous/">A sphere in a homogenous field</a></li><li class="current"><a class="toctext" href>A sphere in a point charge field.</a><ul class="internal"></ul></li><li><a class="toctext" href="../mdrop/">Magnetic liquid droplet in magnetic field</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>A sphere in a point charge field.</a></li></ul><a class="edit-page" href="https://github.com/akels/LaplaceBIE.jl/blob/master/examples/pointlike.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>A sphere in a point charge field.</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="A-sphere-in-a-point-charge-field.-1" href="#A-sphere-in-a-point-charge-field.-1">A sphere in a point charge field.</a></h1><p>In general, the LaplaceBIE allows finding the field on the body&#39;s surface if the potential in the absence of an object(s) is known. (Though one can not add objects one by one to get the solution directly. One, however, should be able to make an iterative scheme in the lines of multipole method.) To demonstrate that, let&#39;s consider a field on the dielectric sphere (radius r1) due to a point charge at distance ζ away. The solution inside the sphere is given as series [Straton page 221]:</p><div>\[\psi = \sum_{n=0}^{\infty} \frac{2n + 1}{\epsilon n + n + 1} \frac{r_1^n}{\zeta^{n+1}} L_n(\cos \theta)\]</div><p>where <span>$L_n$</span> is Legendre polynomial and <span>$\theta$</span> angle from line connecting point charge and spehre.</p><pre><code class="language-julia">using Jacobi
function ψt(cosθ,ϵ,ζ,r1)
    s = 0
    for n in 0:25
        s += (2*n + 1)/(n*ϵ + n + 1)*r1^n/ζ^(n+1)*legendre(cosθ,n)
    end
    return s
end</code></pre><pre><code class="language-none">ψt (generic function with 1 method)</code></pre><p>The normal derivative can also be given for the sphere which coincides with derivative in the radial direction:</p><div>\[\frac{\partial \psi}{\partial n} = \sum_{n=0}^{\infty} \frac{n(2n + 1)}{\epsilon n + n + 1} \frac{r_1^{n-1}}{\zeta^{n+1}} L_n(\cos \theta)\]</div><pre><code class="language-julia">function ∇ψn(cosθ,ϵ,ζ,r1)
    s = 0
    for n in 1:25
        s += n*(2*n + 1)/(n*ϵ + n + 1)*r1^(n-1)/ζ^(n+1) * legendre(cosθ,n)
    end
    return s
end</code></pre><pre><code class="language-none">∇ψn (generic function with 1 method)</code></pre><p>First, we can define the exterior potential in the absence of objects:</p><pre><code class="language-julia">using LinearAlgebra

ζ = 1.2
r1 = 1
y = [0,0,ζ]

ψ0(x) = 1/norm(x.-y)
∇ψ0(x) = -(x.-y)/norm(x.-y)^3</code></pre><pre><code class="language-none">∇ψ0 (generic function with 1 method)</code></pre><p>Let&#39;s now place a sphere in the field with relative permittivity <span>$\epsilon=10$</span>.</p><pre><code class="language-julia">ϵ = 10

include(&quot;sphere.jl&quot;)
msh = unitsphere(2)
vertices, faces = msh.vertices, msh.faces
n = vertices</code></pre><pre><code class="language-none">162-element Array{GeometryTypes.Point{3,Float64},1}:
 [-0.525731, 0.850651, 0.0]     
 [0.525731, 0.850651, 0.0]      
 [-0.525731, -0.850651, 0.0]    
 [0.525731, -0.850651, 0.0]     
 [0.0, -0.525731, 0.850651]     
 [0.0, 0.525731, 0.850651]      
 [0.0, -0.525731, -0.850651]    
 [0.0, 0.525731, -0.850651]     
 [0.850651, 0.0, -0.525731]     
 [0.850651, 0.0, 0.525731]      
 ⋮                              
 [0.259892, 0.433889, -0.862668]
 [0.262866, 0.16246, -0.951057] 
 [0.262866, -0.16246, -0.951057]
 [0.961938, 0.0, 0.273267]      
 [0.951057, 0.262866, 0.16246]  
 [0.862668, 0.259892, -0.433889]
 [0.951057, 0.262866, -0.16246] 
 [0.69378, 0.702046, 0.160622]  
 [0.850651, 0.525731, 0.0]      </code></pre><p>With LaplaceBIE to calculate the surface field, we execute these three lines:</p><pre><code class="language-julia">using LaplaceBIE

ψ = surfacepotential(vertices,n,faces,ϵ,ψ0);
P∇ψ = tangentderivatives(vertices,n,faces,ψ);
n∇ψ = normalderivatives(vertices,n,faces,P∇ψ,ϵ,∇ψ0);</code></pre><pre><code class="language-none">162-element Array{Float64,1}:
 -0.06205534122187404 
 -0.06205534122187409 
 -0.062055341221873776
 -0.0620553412218737  
  0.09154529388081165 
  0.09154529388081104 
 -0.06365584711404176 
 -0.06365584711404139 
 -0.06367958215679825 
 -0.04611694351733581 
  ⋮                   
 -0.06373122123157463 
 -0.06363392295695919 
 -0.06363392295695924 
 -0.058521276281101015
 -0.06092044651491289 
 -0.06376068401697485 
 -0.06308197836685234 
 -0.06102685443985198 
 -0.061876924424271076</code></pre><p>Now to compare with analytics, we use azimuthal symmetry, which in numerics was chosen as the x-axis:</p><pre><code class="language-julia">using Winston

cosθ = range(-1,1,length=100)
cosθs = [x[3]/1 for x in vertices]</code></pre><pre><code class="language-none">162-element Array{Float64,1}:
  0.0                
  0.0                
  0.0                
  0.0                
  0.85065080835204   
  0.85065080835204   
 -0.85065080835204   
 -0.85065080835204   
 -0.5257311121191336 
  0.5257311121191336 
  ⋮                  
 -0.8626684804161862 
 -0.9510565162951536 
 -0.9510565162951536 
  0.2732665289126717 
  0.16245984811645317
 -0.4338885645526948 
 -0.16245984811645317
  0.16062203564002314
  0.0                </code></pre><p>Potential on the surface vs analytics:</p><pre><code class="language-julia">scatter(cosθs,ψ)
oplot(cosθ,ψt.(cosθ,ϵ,ζ,r1) )
savefig(&quot;potential.svg&quot;)</code></pre><p><img src="../potential.svg" alt/></p><p>Normal derivatives on the surface vs analytics:</p><pre><code class="language-julia">scatter(cosθs,n∇ψ)
oplot(cosθ,∇ψn.(cosθ,ϵ,ζ,r1) )
savefig(&quot;nderivatives.svg&quot;)</code></pre><p><img src="../nderivatives.svg" alt/></p><footer><hr/><a class="previous" href="../homogenous/"><span class="direction">Previous</span><span class="title">A sphere in a homogenous field</span></a><a class="next" href="../mdrop/"><span class="direction">Next</span><span class="title">Magnetic liquid droplet in magnetic field</span></a></footer></article></body></html>
