<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sphere in a point charge field. · LaplaceBIE.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>LaplaceBIE.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">LaplaceBIE.jl theory (Magnetic or electric force for a smooth bodies)</a></li><li><a class="toctext" href="../homogenous/">Sphere in a homogenous field</a></li><li class="current"><a class="toctext" href>Sphere in a point charge field.</a><ul class="internal"><li><a class="toctext" href="#Analytics-and-the-problem-1">Analytics and the problem</a></li><li><a class="toctext" href="#Numerics-1">Numerics</a></li><li><a class="toctext" href="#Comparision-1">Comparision</a></li></ul></li><li><a class="toctext" href="../mdrop/">Magnetic liquid droplet in magnetic field</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Sphere in a point charge field.</a></li></ul><a class="edit-page" href="https://github.com/akels/LaplaceBIE.jl/blob/master/examples/pointlike.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Sphere in a point charge field.</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Sphere-in-a-point-charge-field.-1" href="#Sphere-in-a-point-charge-field.-1">Sphere in a point charge field.</a></h1><h2><a class="nav-anchor" id="Analytics-and-the-problem-1" href="#Analytics-and-the-problem-1">Analytics and the problem</a></h2><p>In general the LaplaceBIE allows to find field on the object if the potential in absence of objects is known. To demonstrate that let&#39;s consider a field on the dielectric sphere (radius <span>$r_1$</span>) due to a point charge at distance <span>$\zeta$</span> away. The solution inside the sphere is given as series [Straton page 221]:</p><div>\[\psi = \sum_{n=0}^{\infty} \frac{2n + 1}{\epsilon n + n + 1} \frac{r_1^n}{\zeta^{n+1}} L_n(\cos \theta)\]</div><p>where <span>$L_n$</span> is Legendre polynomial and <span>$\theta$</span> angle from line connecting point charge and spehre.</p><p>The normal derivative can also be given for the sphere which coincides with derivative in the radial direction</p><div>\[\frac{\partial \psi}{\partial n} = \sum_{n=0}^{\infty} \frac{n(2n + 1)}{\epsilon n + n + 1} \frac{r_1^{n-1}}{\zeta^{n+1}} L_n(\cos \theta)\]</div><pre><code class="language-julia">using Jacobi

function ψt(cosθ,ϵ,ζ,r1)
    s = 0
    for n in 0:25
        s += (2*n + 1)/(n*ϵ + n + 1)*r1^n/ζ^(n+1)*legendre(cosθ,n)
    end
    return s
end

function ∇ψn(cosθ,ϵ,ζ,r1)
    s = 0
    for n in 1:25
        s += n*(2*n + 1)/(n*ϵ + n + 1)*r1^(n-1)/ζ^(n+1) * legendre(cosθ,n)
    end
    return s
end</code></pre><pre><code class="language-none">∇ψn (generic function with 1 method)</code></pre><h2><a class="nav-anchor" id="Numerics-1" href="#Numerics-1">Numerics</a></h2><p>First we need to load a sphere mesh.</p><pre><code class="language-julia">using LinearAlgebra
using GeometryTypes
using SurfaceTopology
using LaplaceBIE

include(&quot;sphere.jl&quot;)
msh = unitsphere(2)
vertices, faces = msh.vertices, msh.faces
n = vertices</code></pre><pre><code class="language-none">162-element Array{GeometryTypes.Point{3,Float64},1}:
 [-0.5257311121191336, 0.85065080835204, 0.0]                    
 [0.5257311121191336, 0.85065080835204, 0.0]                     
 [-0.5257311121191336, -0.85065080835204, 0.0]                   
 [0.5257311121191336, -0.85065080835204, 0.0]                    
 [0.0, -0.5257311121191336, 0.85065080835204]                    
 [0.0, 0.5257311121191336, 0.85065080835204]                     
 [0.0, -0.5257311121191336, -0.85065080835204]                   
 [0.0, 0.5257311121191336, -0.85065080835204]                    
 [0.85065080835204, 0.0, -0.5257311121191336]                    
 [0.85065080835204, 0.0, 0.5257311121191336]                     
 ⋮                                                               
 [0.25989191300775444, 0.4338885645526948, -0.8626684804161862]  
 [0.26286555605956685, 0.16245984811645317, -0.9510565162951536] 
 [0.26286555605956685, -0.16245984811645317, -0.9510565162951536]
 [0.9619383577839176, 0.0, 0.2732665289126717]                   
 [0.9510565162951536, 0.26286555605956685, 0.16245984811645317]  
 [0.8626684804161862, 0.25989191300775444, -0.4338885645526948]  
 [0.9510565162951536, 0.26286555605956685, -0.16245984811645317] 
 [0.6937804775604491, 0.7020464447761631, 0.16062203564002314]   
 [0.8506508083520399, 0.5257311121191337, 0.0]                   </code></pre><p>The next step is to set up the free field solution which we do as follows</p><pre><code class="language-julia">ζ = 1.2
r1 = 1
y = [0,0,ζ]

freepotential(x) = 1/norm(x.-y)
freefield(x) = -(x.-y)/norm(x.-y)^3</code></pre><pre><code class="language-none">freefield (generic function with 1 method)</code></pre><p>Then in a presence of a sphere with <span>$\epsilon=10$</span> we have a solution:</p><pre><code class="language-julia">ϵ = 10
ψ = surfacepotential(vertices,n,faces,ϵ,freepotential)
P∇ψ = tangentderivatives(vertices,n,faces,ψ)
n∇ψ = normalderivatives(vertices,n,faces,P∇ψ,ϵ,freefield)</code></pre><pre><code class="language-none">162-element Array{Float64,1}:
 -0.062055341221873984
 -0.062055341221873936
 -0.0620553412218738  
 -0.062055341221873526
  0.09154529388081158 
  0.09154529388081106 
 -0.06365584711404174 
 -0.06365584711404115 
 -0.06367958215679814 
 -0.046116943517335696
  ⋮                   
 -0.06373122123157451 
 -0.06363392295695916 
 -0.0636339229569591  
 -0.058521276281101015
 -0.06092044651491295 
 -0.06376068401697485 
 -0.06308197836685228 
 -0.06102685443985198 
 -0.06187692442427106 </code></pre><h2><a class="nav-anchor" id="Comparision-1" href="#Comparision-1">Comparision</a></h2><pre><code class="language-">using Winston

cosθ = range(-1,1,length=100)
cosθs = [x[3]/1 for x in vertices]</code></pre><p>Potential test</p><pre><code class="language-">scatter(cosθs,ψ)
oplot(cosθ,ψt.(cosθ,ϵ,ζ,r1) )</code></pre><p>Test of normal derivatives derivatives</p><pre><code class="language-">scatter(cosθs,n∇ψ)
oplot(cosθ,∇ψn.(cosθ,ϵ,ζ,r1) )</code></pre><footer><hr/><a class="previous" href="../homogenous/"><span class="direction">Previous</span><span class="title">Sphere in a homogenous field</span></a><a class="next" href="../mdrop/"><span class="direction">Next</span><span class="title">Magnetic liquid droplet in magnetic field</span></a></footer></article></body></html>
